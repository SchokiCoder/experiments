/* Copyright (c) 2023 - 2024, Andy Frank Schoknecht
 * Use of this source code is governed by the BSD-3-Clause
 * license, that can be found in the LICENSE file.
 */

#include "cgen.h"

#include <stdio.h>

static FILE *target;

void
CG_print_headerbegin(FILE *file, const char *headerguard)
{
	target = file;

	fprintf(target,
	        "#ifndef %s\n"
	        "#define %s\n\n",
	        headerguard, headerguard);

	fprintf(target,
	        "/* DON'T EDIT THIS FILE. It was generated by a program. */\n\n");
}

void
CG_print_definition(const char *name, const char *value)
{
	fprintf(target, "#define %s %s\n", name, value);
}

void
CG_print_variable(const enum CG_Scope scope,
                  const char *type,
                  const char *name,
                  const char *value)
{
	char *scope_str;

	switch (scope) {
	case CG_S_NORMAL:
		scope_str = "";
		break;

	case CG_S_EXTERN:
		scope_str = "extern ";
		break;

	case CG_S_STATIC:
		scope_str = "static ";
		break;
	}

	fprintf(target, "%s%s %s = %s;\n", scope_str, type, name, value);
}

void
CG_print_headerend()
{
	fprintf(target, "\n" "#endif /* headerguard */\n");
	target = NULL;
}
